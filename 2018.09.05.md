﻿# 2018.09.05## CRT 분석### PlayerManager script - update() : 화살표 방향에 따라 MapManager의 IncreaseFocusPointX또는 Y를 수정한다. => 카메라의 포커스를 의미하는듯..?### MapManager script - Instance : MapManager의 인스턴스들을 public static 으로 지정하여 다른 script에서 쓸 수 있도록 함. [ public static MapManager Instance {get; private set;} - MapHorizontalCount : 20으로 고정. 맵의 x칸수. - MapVericalCount : 초기값 없음. 맵의 (2d)y칸수. - FocusY : FocusPoint.z를10으로 나눈 값을 리턴하여 get함. 왜 이렇게 돌려서 get하는 방식을 사용하는걸까...? - Lines : Dictionary<int, LineObject>의 형식. 맵을 구성하는 Line의 종류별로 리스트화한 Dictionary - FocusPoint : Vector3.zero로 초기화되어있다. 이후에 Player(camera)의 위치에 따라 바뀐다. - Awake() : Instance와 Lines를 초기화 - Start() : GenerateMap()을 실행하고, UpdateMapObjectsActivate()를 실행한다. - IncreaseFocusPointX(int val) : FocusPoint의 x를 val*10만큼 이동한다. - IncreaseFocusPointY(int val) : FocusPoint의 z를 val*10만큼 이동한다. (2차원에서의 y는 3차원에서의 z로 통하기때문)동시에 UpdateMapObjectActivate()를 실행하여 맵을 갱신한다. - UpdateMapObjectActivate() : beforeIndex(현재 포커스 기준 맵의 가장 아래에 있는 라인을 나타내는 인덱스(FocusY-15) % MapVerticalCount)와 afterIndex(현재 포커스 기준 맵의 가장 위에 있는 라인을 나타내는 인덱스) 를 사용하여, beforeIndex가 0이상이라면 Lines[beforeIndex]의 벡터를 z방향으로 10* MapVerticalCount만큼 옮기고, Lines[beforeIndex].SetDisplay(false)로 설정하여 Line Object를 보이지 않게 한다. 그리고 (beforeIndex가 0보다 크든작든간에) Lines[afterIndes].SetDisplay(true)로 다음 Line Object를 활성화한다.개어렵네 질문해야함....!!!!!! - GenerateMap() : BlockObject인 nextBlock을 선언하고, i<MapVerticalCount만큼의 for루프를사용하여,  nextBlock을 targetBlock으로 지정하여 i<6일 때에는 MapPrefebs의 startBlocks를 get하여 랜덤한 index의 block object를 targetBlock으로 정한다. 만약 i>=6이고 targetBlock이 null이라면, 확률적으로 generateInitType은 초기화(Unitstate.NoUnit = 0)하고, generateUnitType을 1부터 3까지 숫자중 랜덤하게 지정한다. 이때 정해진 generateUnitType은 blocks가 어떤 blockObject를 담을 것인지 결정하고, blocks의 랜덤한 index의 block object를 targetBlock으로 정한다. 위의 과정을 통해 targetBlock이 정해지면, targetBlock의 blockIndex가 0이라면 nextBlock은 targetBlock의 NextVertical이 된다. 그렇지만 targetBlock의 blockIndex가 1이라면, 35%의 확률로 targetBlock의 nextVertical이  nextBlock이 되거나 65%의 확률로 nextBlock이 targetBlock그대로 된다. targetBlock의 blockIndex가 2이상이라면 nextBlock은 StartBlocks(0)의 마지막 인덱스의 block이 된다....?  ////LineObject를 사용하는 코드.... 다른 코드를 먼저 읽고 와야겠다.////### MapPrefebs script - Instance : public static MapPrefebs Instance {get; private set;} - BlockObjects : Dickjtionary<int, BlockObject>형식. get, set가능. - Awake() : BlockObjects와 Instance를 초기화. 모든 자식 Object들(transform)에 걸쳐, BlockObject component에 접근하여, BlockObjects가 해당 Code를 이미 가지고 있다면 에러메세지를 출력하거나, 해당 Code가 없다면 BlockObjects에 Add하는 작업을 반복한다. 이 반복이 끝나면 GameObject를 비활성화한다. (한마디로, BlockIbjects에 모든 blockObject들을 Dictionary의 형태로 저장해두고, prefeb으로서의 object들은 비활성화하여 보이지 않게 하는 과정)