# 2018.07.31 TIL## CSharp### delegate1. delegate 는 메소드 참조를 포함하고 있는 대리자이다.2. 형식 : delegate 반환형 델리게이트명(매개변수, .... , ....);3. 역할 - 메소드를 매개변수로 넘길 수 있다.(매개변수의 데이터 형식과 반환형과 개수는 참조할 메소드의 것과 맞추어야 한다.)### delegate example11. delegate는 매개변수의 형식과 개수, 변환형만 맞다면, 이미 있는 메소드 를 대신할 수도 있고, 새로운 메소드를 만들 수도 있는듯하다.2. 아래의 코드는, int형의 PDelegate가 쓰이는 두가지 유형에 대한 코드이다. 이미 있는 Plus 메소드(static)를 대신하기도하며, 이름 없이 새로 메소드를 만들어 사용하기도 한다. 이 경우에는 대입할 때에 delegate(매개변수)를 대입한다.```using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace ConsoleApp1{	delegate int PDelegate(int a, int b);	class Program	{		static int Plus(int a, int b)		{			return a + b;		}		static void Main(string[] args)		{			PDelegate pd1 = Plus;			PDelegate pd2 = delegate (int a, int b)			{				return a / b;			};			Console.WriteLine(pd1(10, 5));			Console.WriteLine(pd2(10, 5));		}	}}```결과```152```### delegate example 2 (delegate chain)1. 델리게이트 하나를 가지고 여러개의 메소드를 한번에 호출할 수 있다. 2. (PDelegate)Delegate.Combine(new PDelegate(메소드), ... , ...) 와 같은 형식으로 각 메소드를 실행할 수 있다.```using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace ConsoleApp1{	delegate void PDelegate(int a, int b);	class Program	{		static void Plus(int a, int b)		{			Console.WriteLine("{0} + {1} = {2}", a, b, a + b);		}		static void Minus(int a, int b)		{			Console.WriteLine("{0} - {1} = {2}", a, b, a - b);		}		static void Multiplication(int a, int b)		{			Console.WriteLine("{0} * {1} = {2}", a, b, a * b);		}		static void Division(int a, int b)		{			Console.WriteLine("{0} / {1} = {2}", a, b, a / b);		}		static void Main(string[] args)		{			PDelegate pd = (PDelegate)Delegate.Combine(				new PDelegate(Plus), new PDelegate(Minus), new PDelegate(Division), new PDelegate(Multiplication));			pd(20, 10);		}	}}```결과```20 + 10 = 3020 - 10 = 1020 / 10 = 220 * 10 = 200```### Delegate example 31. event 키워드를 사용하여 델리게이트로 이벤트를 처리할 수 있다.2. event 형식은 델리게이트와 같이, 다른 메소드의 실행을 사용할 수 있다.```using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;namespace ConsoleApp1{	public delegate void MyEventHandler(string message);	class Publisher	{		public event MyEventHandler Active;		public void DoActive(int number)		{			if (number % 10 == 0)				Active("Active!" + number);			else				Console.WriteLine(number);		}	}	class Subscriber	{		static public void MyHandler(string message)		{			Console.WriteLine(message);		}		static void Main(string[] args)		{			Publisher publisher = new Publisher();			publisher.Active += new MyEventHandler(MyHandler);			for(int i = 1; i < 11; i++)			{				publisher.DoActive(i);			}		}	}}```결과```123456789Active!10```### unity에서의 delegate1. unity에서 델리게이트는, event를 처리할 때 쓰인다.2. public OnclickEvent를 지정하면, 해당 GameObject g를 클릭할 시 오브젝트가 지워지도록 하는 코드이다.```using UnityEngine;using System.Collections; public class Clicker : MonoBehaviour {     public delegate void OnClickEvent(GameObject g);    public static event OnClickEvent OnClick;         void Update ()    {        Ray ray = Camera.mainCamera.ScreenPointToRay(Input.mousePosition);                 RaycastHit hit;                 if (Physics.Raycast(ray, out hit, 100))        {                        if (Input.GetMouseButtonUp(0))            {                OnClick(hit.transform.gameObject);            }        }    }}  using UnityEngine;using System.Collections; public class GoldPile : MonoBehaviour {     void Awake ()    {        Clicker.OnClick += OnClick;    }         void OnClick(GameObject g)    {        if (g == gameObject)        {            Debug.Log("Hide and give us money!");                         gameObject.active = false;        }    }}```## 내일 할일1. delegate를 이용하든, Manager script를 정리하기. 2. 화면이 up 벡터를 돌아가지 않도록 제한하기.3. enemy가 떨어지는 지점을 제한하기.