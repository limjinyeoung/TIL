# 2018.09.13 TIL## CRT### 충돌검사1. Car, Tain 에 boxCollider와 rigidbody component를 add한다. 이 때, unit들의 차선이 어긋나지 않도록 Constrains를 모두 freeze한다.2. player스크립트가 있는 Player object에 Box BoxCollider와 rigidbody component를 add한다. 이 때, rotation만 freeze하고 position은 그대로 둔다. (물리연산을 쓸 수도 있으니..) Box collider는 player의 크기에 맞게 다시 조절해야 한다. 또, 맵(바닥)에는 rigidbody나 BoxCollider를 add하지 않았으니, Use Gravity는 해제한다.### 충돌 모션 - 충돌시 역방향으로 플레이어가 날아가는 효과 (Player script) ```	void Update () {		if (GameManager.Instance.isPlaying && isAlive)		{			Position += (Destination - Position) * 0.1f;		}		else if(!isAlive)		{			Position += colDirection * 1f;		}		//Time.timeScale = 0; update가 돌아가도 time이 증가를 안함.	}	private Vector3 colDirection;	private void OnCollisionEnter(Collision collision)	{		if (collision.transform.tag.Equals("Car") || collision.transform.tag.Equals("Train"))		{			isAlive = false;			colDirection = (transform.position - collision.gameObject.transform.position).normalized;			colDirection.y = 1;			GameManager.Instance.GameOver();		}		//GameManager.Instance.ResetGame();	} ```  - unit과 충돌하면, 플레이어의 생존여부를 판단한 후, 충돌 방향을 계산한 후, GameManager의 GameOver()호출  - Update내용은 isAlive의 여부에 따라 다른데, 기존의 Destination을 사용한 움직임 대신 충돌벡터로 이동하는 연산을 쓴다. - GameOver (GameManager) ```	public void GameOver()	{		UIManager.Instance.SetGameOverPopuUpEnable();		StartCoroutine(WaitToStop(2f));	}	IEnumerator WaitToStop(float s)	{		yield return new WaitForSeconds(2f);		Time.timeScale = 0;	} ```  - 플레이어가 unit고 충돌시 호출되는 함수.  - 팝업창을 먼저 띄우고, 2초뒤에 게임이 멈추게 하는 효과.(플레이어가 날아가는 모습을 생생히 하기 위해....) - GameOverPopUp (UIManager) ```	public void SetGameOverPopuUpEnable()	{		gameOverPopup.enabled = true;		gameOverPopup.PlayForward();	} ```  - GameOverPopuUp은 그냥 PopUp창을 복붙하되 PauseButton은 삭제. (내일 UI를 깔끔히 마감할 것!!!)