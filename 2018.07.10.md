﻿# 2018.07.10 TIL## Unity - Overwatch### Effect1. Effect script```using System.Collections;using System.Collections.Generic;using UnityEngine;public class Effect : MonoBehaviour {    private float period;    public static GameObject Play(GameObject origin, Vector3 position, Vector3 lookAt, float period)    {        GameObject effect = GameObject.Instantiate(origin);        effect.transform.position = position;        effect.transform.LookAt(lookAt);        effect.GetComponent<Effect>().period = period;        effect.SetActive(true);                return effect;    }	// Use this for initialization	void Start () {        StartCoroutine(DestroyGameObject(this.gameObject, period));    }		// Update is called once per frame	void Update () {			}    IEnumerator DestroyGameObject(GameObject go, float seconds)    {        yield return new WaitForSeconds(seconds);        GameObject.Destroy(go);    }}``` - 다른 script에서 Effect.Play로 Effect GameObject가 생성되며, 지정된 시간 뒤에 파괴된다.2. Play - play를 원하는 effect의 origin(prefabManager에서 접근가능한 GameObject의 원본.)과, 재생 위치와 방향(lookat)과, 재생 시간을 매개변수로 받는다. - effect의 위치와 방향을 지정하고, script component에 접근해 period를 입력한다. - effect를 setActive하여 재생한다.3. DestroyGameObject - effect의 GameObject와, Play에서 매개변수로 받은 period를 매개변수로 하는 IEnumerator - 지정된 시간(period)이후에 effect의 GameObject를 파괴한다.### Items1. Item으로는 gold, golds, potion가 있다.2. 각 GameObject들은 BoxCollider와 rigidbody component를 가지고 있고, physic Material로 bounciness 1을 가지고 있다.3. enemy가 죽을 때 생기며, player와 접촉하면 사라진다. (※이후에 수정 필요. item script를 만들어서 generate를 분리하고, 효과와 effect를 정리해야 할 것.)4. enemy script중```GameObject item_gold = GameObject.Instantiate(PrefabManager.Instance.item_gold);                item_gold.transform.position = this.transform.position+this.transform.up*2;                item_gold.SetActive(true);                item_gold.GetComponent<Rigidbody>().AddForce(this.transform.up * 100 + this.transform.right * 100);```5. player script중```if (collision.transform.tag.Equals("Item_Gold"))        {            GameObject.Destroy(collision.gameObject);        }```### effect particles 1. Effect_gold - 플레이어의 주의를 끌 수 있도록 금이 반짝반짝 빛나는 효과. - gold아이템의 하위 object로 두고, looping에 체크하여 gold가 존재하는동안 항상 함께 실행되도록 한다. - 둥근 빛과 같은 light texture를 사용한 Effect_gold Material을 particles/additive셰이더로 쓴다. - billboard render 모드로, 둥근 빛의 형태를 찌그러트리는 일 없이 표현할 수 있도록 한다. - 하늘을 보고 넓게 쏘아올리는 cone shape로 지정하여, 빛이 올라오는 느낌을 준다. - Lifetime은 길게 잡되, size over lifetime을 굴곡있게 조절하여 자연스럽게 연출한다.2. Effect_HitSend - 모래나 바위 등, 맵의 요소에 총알이 맞을 경우, 모래가 튀는 듯한 효과. - loop없이 매우 짧은 순간 빠르게 튀며, 중력의 영향을 받아야 한다. - 모래가 튀는 방향성이 나타나도록 Stretched Billboard mode를 사용한다. (이 모드를 사용할 때, pivot이나 speed scale등이 매우 이상하게 잡힐 수 있으니, play해보면서 직접 조절해봐야 할 것같다...) - hemisphere (반구) shape를 사용하여, 총알이 맞은 뒤 전방의 반구 범위로 튀는 모래를 표현할 수 있게 한다. - start Size를 curve로 조절하여, 총알이 박히는 순간 많은 모래가 튀고, 점점 작은 모래가 튀는 효과를 낸다. (0.2초의 짧은 순간이지만, 뭔가 있어보임) - gravity Modifier를 0.8로 주어서 자연스럽게 모래 역시 중력의 영향을 받아 약간 아래로 쳐지는 곡선을 그리도록 한다.### 내일 할 일1. ui만들기 (에임점, 체력, 총알, 금 보유량)2. item script 분리, 효과 수정.