# 2018.12.07 TIL## Shader### Water shader```Shader "Custom/WaterShader"{    Properties    {        _MainTex ("Texture", 2D) = "white" {}        _NormalTex ("Normal Map", 2D) = "white" {}		_SpecTex("Specular Map", 2D) = "white" {}		_LightPos("Light Position", Vector) = (0,0,0)    }    SubShader    {		Zwrite Off		Blend OneMinusDstColor One        Tags { "RenderType"="Opaque" }        LOD 100        Pass        {            CGPROGRAM            #pragma vertex vert            #pragma fragment frag            #pragma multi_compile_fog                        #include "UnityCG.cginc"            struct appdata            {                float4 vertex : POSITION;                float2 uv : TEXCOORD0;				float3 normal : NORMAL;            };            struct v2f            {                float2 uv : TEXCOORD0;                UNITY_FOG_COORDS(1)                float4 vertex : SV_POSITION;				float3 normal : TEXCOORD1;				float3 worldPos : TEXCOORD2;            };                        sampler2D _NormalTex;			sampler2D _SpecTex;            sampler2D _MainTex;                        float4 _NormalTex_ST;			float4 _SpecTex_ST;            float4 _MainTex_ST;			float3 _LightPos;                        v2f vert (appdata_base v)            {                v2f o;                o.vertex = UnityObjectToClipPos(v.vertex);				o.worldPos = v.vertex;                o.uv = v.texcoord;				o.normal = v.normal;                return o;            }                        fixed4 frag (v2f i) : SV_Target            {				fixed4 norm = tex2D(_NormalTex, i.uv);				fixed4 spec = tex2D(_SpecTex, i.uv);				float2 coord = i.uv;				float wave = sin(_Time.x * 10 - norm.x * 20);				coord.xy += norm.xy * 0.001 * wave;				coord.y += _Time.x * 0.1;				coord.xy *= 20;				spec = tex2D(_NormalTex, coord);				float3 finalNorm = i.normal + (spec - 0.5) * 0.6;				float3 pointToCam = normalize(_WorldSpaceCameraPos - i.worldPos);				float3 lightToPoint = normalize(i.worldPos - _LightPos);				float3 reflectVector = reflect(lightToPoint, finalNorm);				float dotValue = dot(normalize(reflectVector), normalize(pointToCam));				if (dotValue < 0) dotValue = 0;				float3 specColor = float3(1, 1, 1) * pow(dotValue, 50);				float3 colorDefault = tex2D(_MainTex, coord);				float colorDot = dot(finalNorm, -lightToPoint);				if (colorDot < 0.3) colorDot = -0.3;				float3 finalColor = colorDefault * 0.4 + colorDefault * 0.6 * colorDot;				float3 finalTex = finalColor + specColor;				/*                float2 coord = i.uv;                coord.xy += norm.xy * 0.01 * sin(_Time.x *10 + i.uv.x * 10);                coord.xy *= 20;				coord.x += _Time.x;				coord.y += _Time.x * 0.1;                                fixed4 col = tex2D(_MainTex, coord);				                                // apply fog                UNITY_APPLY_FOG(i.fogCoord, col);				*/				return float4 (finalTex, 1);            }            ENDCG        }    }}```