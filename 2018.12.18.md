# 2018.12.18 TIL## shader### water shader```Shader "Custom/WaterShader"{    Properties    {        _MainTex ("Texture", 2D) = "white" {}        _NormalTex ("Normal Map", 2D) = "white" {}		_SpecTex("Specular Map", 2D) = "white" {}		_LightPos("Light Position", Vector) = (0,0,0)    }    SubShader    {		Zwrite Off		Blend OneMinusDstColor One        Tags { "RenderType"="Opaque" }        LOD 100        Pass        {            CGPROGRAM            #pragma vertex vert            #pragma fragment frag            #pragma multi_compile_fog                        #include "UnityCG.cginc"            struct appdata            {                float4 vertex : POSITION;                float2 uv : TEXCOORD0;				float3 normal : NORMAL;            };            struct v2f            {                float2 uv : TEXCOORD0;                UNITY_FOG_COORDS(1)                float4 vertex : SV_POSITION;				float3 normal : TEXCOORD1;				float3 worldPos : TEXCOORD2;            };                        sampler2D _NormalTex;			sampler2D _SpecTex;            sampler2D _MainTex;                        float4 _NormalTex_ST;			float4 _SpecTex_ST;            float4 _MainTex_ST;			float3 _LightPos;                        v2f vert (appdata_base v)            {                v2f o;                o.vertex = UnityObjectToClipPos(v.vertex);				o.worldPos = v.vertex;                o.uv = v.texcoord;				o.normal = v.normal;                return o;            }                        fixed4 frag (v2f i) : SV_Target            {				fixed4 specNorm = tex2D(_SpecTex, i.uv);				float2 specCoord = i.uv;				specCoord.xy += specNorm.xy * sin(_Time.x - specNorm.x * 10);				fixed4 norm = tex2D(_NormalTex, specCoord) + specNorm;								float2 coord = i.uv;								coord.xy += norm.xy * 0.002 * sin(_Time.x * 20 - norm.x * 20);				//coord.y += _Time.x * 0.1;				coord.xy *= 20;				norm = tex2D(_NormalTex, coord);				float3 finalNorm = i.normal + (norm - 0.5) * 0.6;				float3 pointToCam = normalize(_WorldSpaceCameraPos - i.worldPos);				float3 lightToPoint = normalize(i.worldPos - _LightPos);				float3 reflectVector = reflect(lightToPoint, finalNorm);				float dotValue = dot(normalize(reflectVector), normalize(pointToCam));				if (dotValue < 0) dotValue = 0;				float3 specColor = float3(1, 1, 1) * pow(dotValue, 50);				float3 colorDefault = tex2D(_MainTex, coord);				float colorDot = dot(finalNorm, -lightToPoint);				if (colorDot < 0.3) colorDot = -0.3;				float3 finalColor = colorDefault * 0.4 + colorDefault * 0.6 * colorDot;				float3 finalTex = finalColor + specColor;				return float4 (finalTex, 1);            }            ENDCG        }    }}```1. 위의 코드는, specNorm을 이용하여, norm 을 흔들고, 흔들린 norm을 MainTex로 만드는 코드이다.2. norm이 불규칙적으로 흔들리게 되면 단조로운 파동이 역동적으로 흔들릴 것이라 예상했지만, 많은 차이를 가져오진 못한듯 하다.3. norm을 흔들리게가 아니라 왜곡되게 한다면..?나쁘지 않을듯 하다. (specNorm의 영향을 키움)4. 수치로써의 물결의 운동과 normal map의 모양이 일치하면 더 깔끔할 것 같다....### flame shader```Shader "Custom/Flame" {	Properties	{		_MainTex("Texture", 2D) = "white" {}		_NormalTex("Normal Map", 2D) = "white" {}	}		SubShader	{		Zwrite Off		Blend OneMinusDstColor One		Tags{ "RenderType" = "Opaque" }		LOD 100		Pass	{		CGPROGRAM#pragma vertex vert#pragma fragment frag#pragma multi_compile_fog#include "UnityCG.cginc"		struct appdata	{		float4 vertex : POSITION;		float2 uv : TEXCOORD0;		float3 normal : NORMAL;	};	struct v2f	{		float2 uv : TEXCOORD0;		UNITY_FOG_COORDS(1)		float4 vertex : SV_POSITION;		float3 normal : TEXCOORD1;	};	sampler2D _NormalTex;	sampler2D _SpecTex;	sampler2D _MainTex;	float4 _NormalTex_ST;	float4 _MainTex_ST;	v2f vert(appdata_base v)	{		v2f o;		o.vertex = UnityObjectToClipPos(v.vertex);		o.uv = v.texcoord;		o.normal = v.normal;		return o;	}	fixed4 frag(v2f i) : SV_Target	{		fixed4 norm = tex2D(_NormalTex, i.uv);		float2 coord = i.uv;		coord.x += norm.x * 0.02 * sin(norm.x * 10 + _Time.y *5);	return tex2D(_MainTex, coord);	}		ENDCG	}	}}```1. 이렇게 소스가 없을줄이야2. 위아래가 아니라 양 옆으로만 흔들리는 불꽃. 노말맵의 영향인지 흔들리지 않길 원하는 부분도 흔들린다.