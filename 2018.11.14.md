# 2018.11.14 TIL## Acade### ItemManager```using System.Collections;using System.Collections.Generic;using UnityEngine;public class AcadeItemManager : MonoBehaviour {	public static AcadeItemManager Instance { get; private set; }	public GameObject Star;	public GameObject[] Items;	// Use this for initialization	void Start () {		Instance = this;		InvokeRepeating("RegenStar", 3, 1);	}		// Update is called once per frame	void Update () {			}	public void GenerateItem(Vector3 pos)	{		GameObject item = GameObject.Instantiate(Items[(int)Random.Range(0, Items.Length)]);		item.transform.position = pos;		item.SetActive(true);	}	void RegenStar()	{		if (AcadeGameManager.Instance.isPlaying)		{			GameObject star = (GameObject)Instantiate(Star, new Vector3(Random.Range(-3.5f, 3.5f), 9, 0f), Quaternion.identity); //랜덤한 위치와, 화면 제일 위에서 Enemy를 하나 생성해줍니다.			star.SetActive(true);		}	}}```1. 기존의 Items에서 Star의 생성을 다루던 코드를 삽입. (Items script는 삭제)2. Items 배열의 아이템중 랜덤 아이템을 생성하는 GenerateItem을 public으로 만들어 다른 script에서 접근 가능하도록 함. => spaceship이 파괴될 때 AcadeItemManager.Instance.GenerateItem(this.transform.position);3. GenerateItem은 랜덤 아이템을 지정한 좌표에 생성하고 활성화시킴.### Item```using System.Collections;using System.Collections.Generic;using UnityEngine;public class SpeedItem : MonoBehaviour {	// Use this for initialization	void Start () {			}		// Update is called once per frame	void Update () {		if (AcadeGameManager.Instance.isPlaying)		{			this.transform.position -= transform.up * AcadeGameManager.Instance.GameSpeed * 2.5f;		}	}	private void OnCollisionEnter2D(Collision2D collision)	{		if (collision.transform.tag == "Limit")			GameObject.Destroy(this.gameObject);		else if (collision.transform.tag == "Player")			GameObject.Destroy(this.gameObject);	}}```1. 현재 Heart Item과 Speed Item 존재. 2. 현재의 코드는, Item에서는 충돌검사를 통한 destroy만 하고, 효과 적용은 Player script에서 tag 검사 후에 효과를 적용한다. => tag정리 필요3. Update시에는 조금 빠른 속도로 아이템이 조금씩 떨어지도록 함.### Effect```using System.Collections;using System.Collections.Generic;using UnityEngine;public class AcadeEffectManager : MonoBehaviour {	public static AcadeEffectManager Instance { get; private set; }	public enum EffectNum { BURST }	public GameObject[] Effects;	// Use this for initialization	void Start () {		Instance = this;	}		// Update is called once per frame	void Update () {			}	public void PlayEffect(EffectNum en, Vector3 pos)	{		GameObject effect = GameObject.Instantiate(Effects[(int)en]);		effect.SetActive(true);		effect.transform.position = pos;		StartCoroutine(DestroyObject(effect));	}		IEnumerator DestroyObject(GameObject go)	{		yield return new WaitForSeconds(1);		GameObject.Destroy(go);	}}```1. EffectManager는 모든 effect들을 enum 과 배열로 관리한다.2. 외부에서 effect를 사용할 때 PlayeEffect를 사용하여 이펙트와 위치를 매개변수로 전달하여 effect를 활성화시킨다.3. 모든 effect는 1초후에 destroy되도록 IEnumerator를 사용한다. (후에 이또한 매개변수로 받아도 좋을 듯)4. 현재 존재하는 effect는 burst하나로, player가 충돌하는 모든 시점에 충돌지점(collision.contacts[0].point)에서 발생하며, beam이 충돌시에도 발생한다.### Health Bar```	public void healthBarIncrease()	{		if(HealthBar.fillAmount < 1)			HealthBar.fillAmount += 0.2f;	}	public void healthBarDecrease()	{		HealthBar.fillAmount -= 0.2f;		if (HealthBar.fillAmount < 0.2f)			AcadeGameManager.Instance.GameOver();	}```1. UIManager에서 관리한다.2. UISprite인 HealthBar를 생성하고, 적당한 위치를 Unified타입의 앙코르로 잡는다.3. UIsprite의 타입은 Filled, Fill Amount는 Horizontal로 정하여 20%씩 깎이면 하나의 하트가 삭제되는 효과를 낸다.